

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; Bloch Simulator 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />


      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Bloch Simulator Documentation" href="index.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="index.html" class="icon icon-home">
            Bloch Simulator
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-bloch_simulator">Bloch Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.BlochSimulator"><code class="docutils literal notranslate"><span class="pre">BlochSimulator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.BlochSimulator.load_results"><code class="docutils literal notranslate"><span class="pre">BlochSimulator.load_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.BlochSimulator.log_message"><code class="docutils literal notranslate"><span class="pre">BlochSimulator.log_message()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.BlochSimulator.plot_magnetization"><code class="docutils literal notranslate"><span class="pre">BlochSimulator.plot_magnetization()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.BlochSimulator.save_parameters_json"><code class="docutils literal notranslate"><span class="pre">BlochSimulator.save_parameters_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.BlochSimulator.save_results"><code class="docutils literal notranslate"><span class="pre">BlochSimulator.save_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.BlochSimulator.simulate"><code class="docutils literal notranslate"><span class="pre">BlochSimulator.simulate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.BlochSimulator.simulate_phantom"><code class="docutils literal notranslate"><span class="pre">BlochSimulator.simulate_phantom()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.CustomPulse"><code class="docutils literal notranslate"><span class="pre">CustomPulse</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.CustomPulse.compile"><code class="docutils literal notranslate"><span class="pre">CustomPulse.compile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.GradientEcho"><code class="docutils literal notranslate"><span class="pre">GradientEcho</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.GradientEcho.compile"><code class="docutils literal notranslate"><span class="pre">GradientEcho.compile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.PulseSequence"><code class="docutils literal notranslate"><span class="pre">PulseSequence</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.PulseSequence.add_gradient"><code class="docutils literal notranslate"><span class="pre">PulseSequence.add_gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.PulseSequence.add_rf_pulse"><code class="docutils literal notranslate"><span class="pre">PulseSequence.add_rf_pulse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.PulseSequence.compile"><code class="docutils literal notranslate"><span class="pre">PulseSequence.compile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.SliceSelectRephase"><code class="docutils literal notranslate"><span class="pre">SliceSelectRephase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.SliceSelectRephase.compile"><code class="docutils literal notranslate"><span class="pre">SliceSelectRephase.compile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.SpinEcho"><code class="docutils literal notranslate"><span class="pre">SpinEcho</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.SpinEcho.compile"><code class="docutils literal notranslate"><span class="pre">SpinEcho.compile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.SpinEchoTipAxis"><code class="docutils literal notranslate"><span class="pre">SpinEchoTipAxis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.SpinEchoTipAxis.compile"><code class="docutils literal notranslate"><span class="pre">SpinEchoTipAxis.compile()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.TissueParameters"><code class="docutils literal notranslate"><span class="pre">TissueParameters</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.TissueParameters.name"><code class="docutils literal notranslate"><span class="pre">TissueParameters.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.TissueParameters.t1"><code class="docutils literal notranslate"><span class="pre">TissueParameters.t1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.TissueParameters.t2"><code class="docutils literal notranslate"><span class="pre">TissueParameters.t2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.TissueParameters.t2_star"><code class="docutils literal notranslate"><span class="pre">TissueParameters.t2_star</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.TissueParameters.density"><code class="docutils literal notranslate"><span class="pre">TissueParameters.density</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.TissueParameters.csf"><code class="docutils literal notranslate"><span class="pre">TissueParameters.csf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">TissueParameters.density</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.TissueParameters.gray_matter"><code class="docutils literal notranslate"><span class="pre">TissueParameters.gray_matter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">TissueParameters.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">TissueParameters.t1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">TissueParameters.t2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">TissueParameters.t2_star</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bloch_simulator.TissueParameters.white_matter"><code class="docutils literal notranslate"><span class="pre">TissueParameters.white_matter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.design_rf_pulse"><code class="docutils literal notranslate"><span class="pre">design_rf_pulse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.example_fid"><code class="docutils literal notranslate"><span class="pre">example_fid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bloch_simulator.example_spin_echo"><code class="docutils literal notranslate"><span class="pre">example_spin_echo()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kspace_simulator">K-Space Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kspace_simulator.CSIParameters"><code class="docutils literal notranslate"><span class="pre">CSIParameters</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.CSIParameters.matrix_size"><code class="docutils literal notranslate"><span class="pre">CSIParameters.matrix_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.CSIParameters.fov"><code class="docutils literal notranslate"><span class="pre">CSIParameters.fov</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.CSIParameters.spectral_points"><code class="docutils literal notranslate"><span class="pre">CSIParameters.spectral_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.CSIParameters.spectral_bandwidth"><code class="docutils literal notranslate"><span class="pre">CSIParameters.spectral_bandwidth</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.CSIParameters.tr"><code class="docutils literal notranslate"><span class="pre">CSIParameters.tr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.CSIParameters.acquisition_time"><code class="docutils literal notranslate"><span class="pre">CSIParameters.acquisition_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.CSIParameters.dwell_time"><code class="docutils literal notranslate"><span class="pre">CSIParameters.dwell_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">CSIParameters.fov</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">CSIParameters.matrix_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">CSIParameters.spectral_bandwidth</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">CSIParameters.spectral_points</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">CSIParameters.tr</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kspace_simulator.EPIParameters"><code class="docutils literal notranslate"><span class="pre">EPIParameters</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.matrix_size"><code class="docutils literal notranslate"><span class="pre">EPIParameters.matrix_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.fov"><code class="docutils literal notranslate"><span class="pre">EPIParameters.fov</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.echo_spacing"><code class="docutils literal notranslate"><span class="pre">EPIParameters.echo_spacing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.ramp_time"><code class="docutils literal notranslate"><span class="pre">EPIParameters.ramp_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.flat_time"><code class="docutils literal notranslate"><span class="pre">EPIParameters.flat_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.blip_duration"><code class="docutils literal notranslate"><span class="pre">EPIParameters.blip_duration</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.n_shots"><code class="docutils literal notranslate"><span class="pre">EPIParameters.n_shots</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.partial_fourier"><code class="docutils literal notranslate"><span class="pre">EPIParameters.partial_fourier</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.flyback"><code class="docutils literal notranslate"><span class="pre">EPIParameters.flyback</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">EPIParameters.blip_duration</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">EPIParameters.echo_spacing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">EPIParameters.flat_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">EPIParameters.flyback</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">EPIParameters.fov</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EPIParameters.lines_per_shot"><code class="docutils literal notranslate"><span class="pre">EPIParameters.lines_per_shot</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">EPIParameters.matrix_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">EPIParameters.n_shots</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">EPIParameters.partial_fourier</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">EPIParameters.ramp_time</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kspace_simulator.EddyCurrentModel"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EddyCurrentModel.amplitudes"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.amplitudes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EddyCurrentModel.time_constants"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.time_constants</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EddyCurrentModel.axes"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.axes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EddyCurrentModel.cross_terms"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.cross_terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.amplitudes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.EddyCurrentModel.apply_to_gradient"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.apply_to_gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.axes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.cross_terms</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">EddyCurrentModel.time_constants</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.generate_cartesian_trajectory"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.generate_cartesian_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.generate_csi_trajectory"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.generate_csi_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.generate_epi_trajectory"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.generate_epi_trajectory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.log"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.log()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.reconstruct_cartesian"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.reconstruct_cartesian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.reconstruct_csi"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.reconstruct_csi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.reconstruct_epi"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.reconstruct_epi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.set_log_callback"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.set_log_callback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.KSpaceSimulator.simulate_signal"><code class="docutils literal notranslate"><span class="pre">KSpaceSimulator.simulate_signal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kspace_simulator.TrajectoryType"><code class="docutils literal notranslate"><span class="pre">TrajectoryType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.TrajectoryType.CARTESIAN"><code class="docutils literal notranslate"><span class="pre">TrajectoryType.CARTESIAN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.TrajectoryType.CSI"><code class="docutils literal notranslate"><span class="pre">TrajectoryType.CSI</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.TrajectoryType.CUSTOM"><code class="docutils literal notranslate"><span class="pre">TrajectoryType.CUSTOM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.TrajectoryType.EPI"><code class="docutils literal notranslate"><span class="pre">TrajectoryType.EPI</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.TrajectoryType.RADIAL"><code class="docutils literal notranslate"><span class="pre">TrajectoryType.RADIAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kspace_simulator.TrajectoryType.SPIRAL"><code class="docutils literal notranslate"><span class="pre">TrajectoryType.SPIRAL</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kspace_simulator.simulate_csi_spectrum"><code class="docutils literal notranslate"><span class="pre">simulate_csi_spectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kspace_simulator.simulate_epi_with_artifacts"><code class="docutils literal notranslate"><span class="pre">simulate_epi_with_artifacts()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-phantom">Phantoms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#phantom.Phantom"><code class="docutils literal notranslate"><span class="pre">Phantom</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.shape"><code class="docutils literal notranslate"><span class="pre">Phantom.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.fov"><code class="docutils literal notranslate"><span class="pre">Phantom.fov</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.t1_map"><code class="docutils literal notranslate"><span class="pre">Phantom.t1_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.t2_map"><code class="docutils literal notranslate"><span class="pre">Phantom.t2_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.pd_map"><code class="docutils literal notranslate"><span class="pre">Phantom.pd_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.df_map"><code class="docutils literal notranslate"><span class="pre">Phantom.df_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.m0_map"><code class="docutils literal notranslate"><span class="pre">Phantom.m0_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.mask"><code class="docutils literal notranslate"><span class="pre">Phantom.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.name"><code class="docutils literal notranslate"><span class="pre">Phantom.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.metadata"><code class="docutils literal notranslate"><span class="pre">Phantom.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.copy"><code class="docutils literal notranslate"><span class="pre">Phantom.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id31"><code class="docutils literal notranslate"><span class="pre">Phantom.df_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id32"><code class="docutils literal notranslate"><span class="pre">Phantom.fov</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.get_active_properties"><code class="docutils literal notranslate"><span class="pre">Phantom.get_active_properties()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.get_flat_properties"><code class="docutils literal notranslate"><span class="pre">Phantom.get_flat_properties()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.load"><code class="docutils literal notranslate"><span class="pre">Phantom.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33"><code class="docutils literal notranslate"><span class="pre">Phantom.m0_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id34"><code class="docutils literal notranslate"><span class="pre">Phantom.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id35"><code class="docutils literal notranslate"><span class="pre">Phantom.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.n_active"><code class="docutils literal notranslate"><span class="pre">Phantom.n_active</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id36"><code class="docutils literal notranslate"><span class="pre">Phantom.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.ndim"><code class="docutils literal notranslate"><span class="pre">Phantom.ndim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.nvoxels"><code class="docutils literal notranslate"><span class="pre">Phantom.nvoxels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37"><code class="docutils literal notranslate"><span class="pre">Phantom.pd_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.positions"><code class="docutils literal notranslate"><span class="pre">Phantom.positions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.reconstruct_from_active"><code class="docutils literal notranslate"><span class="pre">Phantom.reconstruct_from_active()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.reshape_result"><code class="docutils literal notranslate"><span class="pre">Phantom.reshape_result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.resolution"><code class="docutils literal notranslate"><span class="pre">Phantom.resolution</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.save"><code class="docutils literal notranslate"><span class="pre">Phantom.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id46"><code class="docutils literal notranslate"><span class="pre">Phantom.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id47"><code class="docutils literal notranslate"><span class="pre">Phantom.t1_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id48"><code class="docutils literal notranslate"><span class="pre">Phantom.t2_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.x"><code class="docutils literal notranslate"><span class="pre">Phantom.x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.y"><code class="docutils literal notranslate"><span class="pre">Phantom.y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.Phantom.z"><code class="docutils literal notranslate"><span class="pre">Phantom.z</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#phantom.PhantomFactory"><code class="docutils literal notranslate"><span class="pre">PhantomFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.TISSUE_PARAMS"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.TISSUE_PARAMS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.chemical_shift_phantom"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.chemical_shift_phantom()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.cylindrical_2d"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.cylindrical_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.from_segmentation"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.from_segmentation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.get_tissue_params"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.get_tissue_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.multi_tissue_2d"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.multi_tissue_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.shepp_logan_2d"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.shepp_logan_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.spherical_3d"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.spherical_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#phantom.PhantomFactory.uniform"><code class="docutils literal notranslate"><span class="pre">PhantomFactory.uniform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#phantom.display_phantom"><code class="docutils literal notranslate"><span class="pre">display_phantom()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-pulse_loader">Pulse Loader</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pulse_loader.JCAMPPulseLoader"><code class="docutils literal notranslate"><span class="pre">JCAMPPulseLoader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.JCAMPPulseLoader.load"><code class="docutils literal notranslate"><span class="pre">JCAMPPulseLoader.load()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pulse_loader.PulseLibrary"><code class="docutils literal notranslate"><span class="pre">PulseLibrary</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseLibrary.list_pulses"><code class="docutils literal notranslate"><span class="pre">PulseLibrary.list_pulses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseLibrary.load"><code class="docutils literal notranslate"><span class="pre">PulseLibrary.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseLibrary.load_from_file"><code class="docutils literal notranslate"><span class="pre">PulseLibrary.load_from_file()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pulse_loader.PulseMetadata"><code class="docutils literal notranslate"><span class="pre">PulseMetadata</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.bwfac"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.bwfac</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.duration"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.duration</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.field_strength"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.field_strength</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.flip_angle"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.flip_angle</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.integfac"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.integfac</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.max_b1"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.max_b1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.max_grad"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.max_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.max_slew"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.max_slew</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.maxx"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.maxx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.maxy"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.maxy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.minx"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.minx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.miny"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.miny</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.name"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.npoints"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.npoints</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.nucleus"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.nucleus</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.origin"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.origin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.rephfac"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.rephfac</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.shape_mode"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.shape_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.shape_type"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.shape_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.slice_offset"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.slice_offset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.slice_width"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.slice_width</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.title"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.title</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pulse_loader.PulseMetadata.to_dict"><code class="docutils literal notranslate"><span class="pre">PulseMetadata.to_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pulse_loader.get_pulse_library"><code class="docutils literal notranslate"><span class="pre">get_pulse_library()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pulse_loader.load_amp_phase_dat"><code class="docutils literal notranslate"><span class="pre">load_amp_phase_dat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pulse_loader.load_pulse"><code class="docutils literal notranslate"><span class="pre">load_pulse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pulse_loader.load_pulse_from_file"><code class="docutils literal notranslate"><span class="pre">load_pulse_from_file()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Bloch Simulator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/modules.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<section id="module-bloch_simulator">
<span id="bloch-simulator"></span><h2>Bloch Simulator<a class="headerlink" href="#module-bloch_simulator" title="Link to this heading"></a></h2>
<p>bloch_simulator.py - High-level Python API for Bloch equation simulations</p>
<p>This module provides user-friendly classes and functions for MRI pulse sequence
simulation using the Bloch equations.</p>
<p>Author: Your Name
Date: 2024</p>
<dl class="py class">
<dt class="sig sig-object py" id="bloch_simulator.BlochSimulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">BlochSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_parallel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#BlochSimulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.BlochSimulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>High-level interface for Bloch equation simulations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.BlochSimulator.load_results">
<span class="sig-name descname"><span class="pre">load_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#BlochSimulator.load_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.BlochSimulator.load_results" title="Link to this definition"></a></dt>
<dd><p>Load simulation results from HDF5 file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.BlochSimulator.log_message">
<span class="sig-name descname"><span class="pre">log_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#BlochSimulator.log_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.BlochSimulator.log_message" title="Link to this definition"></a></dt>
<dd><p>Print a message if verbose mode is enabled.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.BlochSimulator.plot_magnetization">
<span class="sig-name descname"><span class="pre">plot_magnetization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#BlochSimulator.plot_magnetization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.BlochSimulator.plot_magnetization" title="Link to this definition"></a></dt>
<dd><p>Plot magnetization evolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> (<em>str</em>) – ‘mx’, ‘my’, ‘mz’, ‘magnitude’, or ‘all’</p></li>
<li><p><strong>position_idx</strong> (<em>int</em>) – Position index to plot</p></li>
<li><p><strong>freq_idx</strong> (<em>int</em>) – Frequency index to plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.BlochSimulator.save_parameters_json">
<span class="sig-name descname"><span class="pre">save_parameters_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_waveforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#BlochSimulator.save_parameters_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.BlochSimulator.save_parameters_json" title="Link to this definition"></a></dt>
<dd><p>Save simulation parameters to JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Output JSON filename</p></li>
<li><p><strong>sequence_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Pulse sequence parameters</p></li>
<li><p><strong>simulation_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Simulation settings</p></li>
<li><p><strong>include_waveforms</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, include RF pulse and gradient waveforms (can be large)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.BlochSimulator.save_results">
<span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#BlochSimulator.save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.BlochSimulator.save_results" title="Link to this definition"></a></dt>
<dd><p>Save simulation results to HDF5 file with complete parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Output HDF5 filename</p></li>
<li><p><strong>sequence_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Pulse sequence parameters (TE, TR, flip angle, etc.)</p></li>
<li><p><strong>simulation_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Simulation settings (mode, dt, parallel settings, etc.)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.BlochSimulator.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><span class="pre">PulseSequence</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bloch_simulator.TissueParameters" title="bloch_simulator.TissueParameters"><span class="pre">TissueParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_magnetization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/bloch_simulator.html#BlochSimulator.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.BlochSimulator.simulate" title="Link to this definition"></a></dt>
<dd><p>Simulate MRI signal using Bloch equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><em>PulseSequence</em></a><em> or </em><em>tuple</em>) – Pulse sequence object or (b1, gradients, time) tuple</p></li>
<li><p><strong>tissue</strong> (<a class="reference internal" href="#bloch_simulator.TissueParameters" title="bloch_simulator.TissueParameters"><em>TissueParameters</em></a>) – Tissue parameters</p></li>
<li><p><strong>positions</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Spatial positions [x, y, z] in meters</p></li>
<li><p><strong>frequencies</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Off-resonance frequencies in Hz</p></li>
<li><p><strong>initial_magnetization</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Initial magnetization state</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Time step for compilation</p></li>
<li><p><strong>mode</strong> (<em>int</em>) – Simulation mode (0: endpoint, 2: time-resolved)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing:
- ‘mx’, ‘my’, ‘mz’: Magnetization components
- ‘signal’: Complex MRI signal
- ‘time’: Time points
- ‘positions’: Positions used
- ‘frequencies’: Frequencies used</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.BlochSimulator.simulate_phantom">
<span class="sig-name descname"><span class="pre">simulate_phantom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phantom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><span class="pre">PulseSequence</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_frequencies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_grouped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/bloch_simulator.html#BlochSimulator.simulate_phantom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.BlochSimulator.simulate_phantom" title="Link to this definition"></a></dt>
<dd><p>Simulate Bloch equations for a heterogeneous phantom.</p>
<p>This method simulates MRI physics for phantoms with spatially-varying
tissue properties (T1, T2, proton density, frequency offset). Each voxel
can have different parameters, enabling realistic imaging simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phantom</strong> (<a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><em>Phantom</em></a>) – Phantom object with tissue property maps (T1, T2, PD, df).
See phantom.py for Phantom class and PhantomFactory.</p></li>
<li><p><strong>sequence</strong> (<a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><em>PulseSequence</em></a><em> or </em><em>tuple</em>) – Either a PulseSequence object or tuple of (b1, gradients, time)</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Time step for sequence compilation (if using PulseSequence)</p></li>
<li><p><strong>mode</strong> (<em>int</em>) – Simulation mode:
- 0: Endpoint only (faster, returns final magnetization)
- 2: Time-resolved (returns magnetization at all time points)</p></li>
<li><p><strong>additional_frequencies</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Extra frequency offsets to simulate (Hz). These are added to
each voxel’s df_map value. Useful for multi-frequency/spectroscopic
imaging.</p></li>
<li><p><strong>use_grouped</strong> (<em>bool</em>) – If True and phantom has discrete tissue labels, use optimized
grouped simulation (faster for segmented phantoms).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Simulation results containing:
- ‘mx’, ‘my’, ‘mz’: Magnetization components</p>
<blockquote>
<div><p>Shape: (<a href="#id1"><span class="problematic" id="id2">*</span></a>phantom.shape,) for mode=0, or (ntime, <a href="#id3"><span class="problematic" id="id4">*</span></a>phantom.shape) for mode=2</p>
</div></blockquote>
<ul class="simple">
<li><p>’signal’: Complex transverse magnetization (mx + 1j*my)</p></li>
<li><p>’time’: Time array from sequence</p></li>
<li><p>’phantom’: The input phantom object</p></li>
<li><p>’pd_weighted_signal’: Signal weighted by proton density</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">phantom</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhantomFactory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Shepp-Logan phantom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phantom</span> <span class="o">=</span> <span class="n">PhantomFactory</span><span class="o">.</span><span class="n">shepp_logan_2d</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create excitation pulse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq</span> <span class="o">=</span> <span class="n">PulseSequence</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq</span><span class="o">.</span><span class="n">add_rf_pulse</span><span class="p">(</span><span class="n">flip_angle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">simulate_phantom</span><span class="p">(</span><span class="n">phantom</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Result shape matches phantom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;mx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (64, 64)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bloch_simulator.CustomPulse">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">CustomPulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pulse_source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_gradient_override</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_b1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#CustomPulse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.CustomPulse" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">PulseSequence</span></code></a></p>
<p>Custom pulse sequence loaded from a file.</p>
<p>Supports Bruker JCAMP-DX format (.exc) and other waveform files.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.CustomPulse.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bloch_simulator.html#CustomPulse.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.CustomPulse.compile" title="Link to this definition"></a></dt>
<dd><p>Compile the custom pulse sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dt</strong> (<em>float</em>) – Time step for resampling (if needed)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>b1</strong> (<em>ndarray</em>) – Complex B1 field (Gauss)</p></li>
<li><p><strong>gradients</strong> (<em>ndarray</em>) – Gradient waveforms (ntime, 3) in Gauss/cm</p></li>
<li><p><strong>time</strong> (<em>ndarray</em>) – Time points in seconds</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bloch_simulator.GradientEcho">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">GradientEcho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">te</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_excitation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_gradient_override</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf_freq_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#GradientEcho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.GradientEcho" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">PulseSequence</span></code></a></p>
<p>Gradient echo pulse sequence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.GradientEcho.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bloch_simulator.html#GradientEcho.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.GradientEcho.compile" title="Link to this definition"></a></dt>
<dd><p>Compile gradient echo sequence.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bloch_simulator.PulseSequence">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">PulseSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#PulseSequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.PulseSequence" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for MRI pulse sequences.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.PulseSequence.add_gradient">
<span class="sig-name descname"><span class="pre">add_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#PulseSequence.add_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.PulseSequence.add_gradient" title="Link to this definition"></a></dt>
<dd><p>Add a gradient to the sequence.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.PulseSequence.add_rf_pulse">
<span class="sig-name descname"><span class="pre">add_rf_pulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#PulseSequence.add_rf_pulse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.PulseSequence.add_rf_pulse" title="Link to this definition"></a></dt>
<dd><p>Add an RF pulse to the sequence.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.PulseSequence.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bloch_simulator.html#PulseSequence.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.PulseSequence.compile" title="Link to this definition"></a></dt>
<dd><p>Compile the sequence into arrays for simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>b1</strong> (<em>ndarray</em>) – Complex B1 field</p></li>
<li><p><strong>gradients</strong> (<em>ndarray</em>) – Gradient waveforms [Gx, Gy, Gz]</p></li>
<li><p><strong>time</strong> (<em>ndarray</em>) – Time points</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bloch_simulator.SliceSelectRephase">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">SliceSelectRephase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flip_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pulse_duration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_bw_product</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rephase_duration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0006</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_gradient_override</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_pulse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#SliceSelectRephase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.SliceSelectRephase" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">PulseSequence</span></code></a></p>
<p>Simple slice-select pulse followed by a rephasing gradient lobe.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.SliceSelectRephase.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bloch_simulator.html#SliceSelectRephase.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.SliceSelectRephase.compile" title="Link to this definition"></a></dt>
<dd><p>Compile a slice-select + rephase waveform.</p>
<p>The slice gradient area during the RF pulse is rewound with a
negative lobe of half the area.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bloch_simulator.SpinEcho">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">SpinEcho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">te</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_excitation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_refocusing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_gradient_override</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">echo_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf_freq_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#SpinEcho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.SpinEcho" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">PulseSequence</span></code></a></p>
<p>Spin echo pulse sequence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.SpinEcho.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bloch_simulator.html#SpinEcho.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.SpinEcho.compile" title="Link to this definition"></a></dt>
<dd><p>Compile spin echo sequence.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bloch_simulator.SpinEchoTipAxis">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">SpinEchoTipAxis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">te</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_excitation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_refocusing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_gradient_override</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">echo_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#SpinEchoTipAxis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.SpinEchoTipAxis" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bloch_simulator.PulseSequence" title="bloch_simulator.PulseSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">PulseSequence</span></code></a></p>
<p>Spin echo where the refocusing 180 is applied around the axis of the tipped magnetization.</p>
<p>Implemented by phase-shifting the 180 pulse by +90 degrees relative to the excitation phase
(CPMG-style: 90° about X, 180° about Y).</p>
<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.SpinEchoTipAxis.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/bloch_simulator.html#SpinEchoTipAxis.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.SpinEchoTipAxis.compile" title="Link to this definition"></a></dt>
<dd><p>Compile the sequence into arrays for simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>b1</strong> (<em>ndarray</em>) – Complex B1 field</p></li>
<li><p><strong>gradients</strong> (<em>ndarray</em>) – Gradient waveforms [Gx, Gy, Gz]</p></li>
<li><p><strong>time</strong> (<em>ndarray</em>) – Time points</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">TissueParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2_star</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#TissueParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.TissueParameters" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for tissue parameters.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#bloch_simulator.TissueParameters.name" title="Link to this definition"></a></dt>
<dd><p>Tissue name</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters.t1">
<span class="sig-name descname"><span class="pre">t1</span></span><a class="headerlink" href="#bloch_simulator.TissueParameters.t1" title="Link to this definition"></a></dt>
<dd><p>T1 relaxation time in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters.t2">
<span class="sig-name descname"><span class="pre">t2</span></span><a class="headerlink" href="#bloch_simulator.TissueParameters.t2" title="Link to this definition"></a></dt>
<dd><p>T2 relaxation time in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters.t2_star">
<span class="sig-name descname"><span class="pre">t2_star</span></span><a class="headerlink" href="#bloch_simulator.TissueParameters.t2_star" title="Link to this definition"></a></dt>
<dd><p>T2* relaxation time in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters.density">
<span class="sig-name descname"><span class="pre">density</span></span><a class="headerlink" href="#bloch_simulator.TissueParameters.density" title="Link to this definition"></a></dt>
<dd><p>Proton density (relative)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters.csf">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">csf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#TissueParameters.csf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.TissueParameters.csf" title="Link to this definition"></a></dt>
<dd><p>CSF parameters at different field strengths.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">density</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters.gray_matter">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gray_matter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#TissueParameters.gray_matter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.TissueParameters.gray_matter" title="Link to this definition"></a></dt>
<dd><p>Gray matter parameters at different field strengths.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">t1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">t2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">t2_star</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bloch_simulator.TissueParameters.white_matter">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">white_matter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#TissueParameters.white_matter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.TissueParameters.white_matter" title="Link to this definition"></a></dt>
<dd><p>White matter parameters at different field strengths.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bloch_simulator.design_rf_pulse">
<span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">design_rf_pulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pulse_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_bw_product</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#design_rf_pulse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.design_rf_pulse" title="Link to this definition"></a></dt>
<dd><p>Pure-Python fallback for RF design so imports work even without the extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pulse_type</strong> (<em>str</em>) – Type of pulse (‘rect’, ‘sinc’, ‘gaussian’, ‘adiabatic_half’, ‘adiabatic_full’, ‘bir4’)</p></li>
<li><p><strong>duration</strong> (<em>float</em>) – Pulse duration in seconds</p></li>
<li><p><strong>flip_angle</strong> (<em>float</em>) – Flip angle in degrees</p></li>
<li><p><strong>time_bw_product</strong> (<em>float</em>) – Time-bandwidth product for sinc/gaussian pulses</p></li>
<li><p><strong>npoints</strong> (<em>int</em>) – Number of time points</p></li>
<li><p><strong>freq_offset</strong> (<em>float</em>) – Frequency offset in Hz (default 0). Applies phase modulation: B1 * exp(2πi*f*t)
Positive offset shifts the pulse frequency higher.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>b1</strong> (<em>complex ndarray</em>) – Complex B1 field in Gauss</p></li>
<li><p><strong>time</strong> (<em>ndarray</em>) – Time points in seconds</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bloch_simulator.example_fid">
<span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">example_fid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#example_fid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.example_fid" title="Link to this definition"></a></dt>
<dd><p>Example: Free Induction Decay simulation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bloch_simulator.example_spin_echo">
<span class="sig-prename descclassname"><span class="pre">bloch_simulator.</span></span><span class="sig-name descname"><span class="pre">example_spin_echo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bloch_simulator.html#example_spin_echo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bloch_simulator.example_spin_echo" title="Link to this definition"></a></dt>
<dd><p>Example: Spin echo simulation.</p>
</dd></dl>

</section>
<section id="module-kspace_simulator">
<span id="k-space-simulator"></span><h2>K-Space Simulator<a class="headerlink" href="#module-kspace_simulator" title="Link to this heading"></a></h2>
<p>kspace_simulator.py - K-space and spectroscopic MRI simulation</p>
<p>This module provides signal-based MRI simulation with proper k-space encoding,
enabling simulation of:
- Gradient-induced phase encoding
- Eddy current effects on spectra and images
- EPI odd/even echo artifacts (Nyquist ghosting)
- Chemical shift imaging (CSI)
- Multi-echo sequences</p>
<dl class="simple">
<dt>The key difference from image-space simulation:</dt><dd><p>Image-space: Compute M(r) at each voxel independently
K-space: Compute S(t) = ∫ M(r,t) × exp(-i·φ(r,t)) dr</p>
</dd>
</dl>
<p>Where φ(r,t) = 2π × k(t)·r includes gradient-induced phase.</p>
<p>Author: Luca Nagel
Date: 2025</p>
<dl class="py class">
<dt class="sig sig-object py" id="kspace_simulator.CSIParameters">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kspace_simulator.</span></span><span class="sig-name descname"><span class="pre">CSIParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(16,</span> <span class="pre">16)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.16,</span> <span class="pre">0.16)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_bandwidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kspace_simulator.html#CSIParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.CSIParameters" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parameters for Chemical Shift Imaging (CSI).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.CSIParameters.matrix_size">
<span class="sig-name descname"><span class="pre">matrix_size</span></span><a class="headerlink" href="#kspace_simulator.CSIParameters.matrix_size" title="Link to this definition"></a></dt>
<dd><p>Spatial matrix size (nx, ny) or (nx, ny, nz)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.CSIParameters.fov">
<span class="sig-name descname"><span class="pre">fov</span></span><a class="headerlink" href="#kspace_simulator.CSIParameters.fov" title="Link to this definition"></a></dt>
<dd><p>Field of view in meters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.CSIParameters.spectral_points">
<span class="sig-name descname"><span class="pre">spectral_points</span></span><a class="headerlink" href="#kspace_simulator.CSIParameters.spectral_points" title="Link to this definition"></a></dt>
<dd><p>Number of spectral (time) points</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.CSIParameters.spectral_bandwidth">
<span class="sig-name descname"><span class="pre">spectral_bandwidth</span></span><a class="headerlink" href="#kspace_simulator.CSIParameters.spectral_bandwidth" title="Link to this definition"></a></dt>
<dd><p>Spectral bandwidth in Hz</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.CSIParameters.tr">
<span class="sig-name descname"><span class="pre">tr</span></span><a class="headerlink" href="#kspace_simulator.CSIParameters.tr" title="Link to this definition"></a></dt>
<dd><p>Repetition time in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kspace_simulator.CSIParameters.acquisition_time">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">acquisition_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#kspace_simulator.CSIParameters.acquisition_time" title="Link to this definition"></a></dt>
<dd><p>Total acquisition time per voxel.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kspace_simulator.CSIParameters.dwell_time">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dwell_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#kspace_simulator.CSIParameters.dwell_time" title="Link to this definition"></a></dt>
<dd><p>Time between spectral samples.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">fov</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(0.16,</span> <span class="pre">0.16)</span></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">matrix_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(16,</span> <span class="pre">16)</span></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">spectral_bandwidth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2000.0</span></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">spectral_points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1024</span></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">tr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.5</span></em><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kspace_simulator.</span></span><span class="sig-name descname"><span class="pre">EPIParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.24,</span> <span class="pre">0.24)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">echo_spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ramp_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blip_duration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partial_fourier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flyback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kspace_simulator.html#EPIParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.EPIParameters" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parameters for EPI (Echo Planar Imaging) trajectory.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.matrix_size">
<span class="sig-name descname"><span class="pre">matrix_size</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.matrix_size" title="Link to this definition"></a></dt>
<dd><p>(nx, ny) matrix size</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.fov">
<span class="sig-name descname"><span class="pre">fov</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.fov" title="Link to this definition"></a></dt>
<dd><p>(fov_x, fov_y) field of view in meters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.echo_spacing">
<span class="sig-name descname"><span class="pre">echo_spacing</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.echo_spacing" title="Link to this definition"></a></dt>
<dd><p>Time between echoes in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.ramp_time">
<span class="sig-name descname"><span class="pre">ramp_time</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.ramp_time" title="Link to this definition"></a></dt>
<dd><p>Gradient ramp time in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.flat_time">
<span class="sig-name descname"><span class="pre">flat_time</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.flat_time" title="Link to this definition"></a></dt>
<dd><p>Gradient flat-top time in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.blip_duration">
<span class="sig-name descname"><span class="pre">blip_duration</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.blip_duration" title="Link to this definition"></a></dt>
<dd><p>Phase-encode blip duration in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.n_shots">
<span class="sig-name descname"><span class="pre">n_shots</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.n_shots" title="Link to this definition"></a></dt>
<dd><p>Number of shots (1 = single-shot EPI)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.partial_fourier">
<span class="sig-name descname"><span class="pre">partial_fourier</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.partial_fourier" title="Link to this definition"></a></dt>
<dd><p>Partial Fourier factor (0.5-1.0)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.flyback">
<span class="sig-name descname"><span class="pre">flyback</span></span><a class="headerlink" href="#kspace_simulator.EPIParameters.flyback" title="Link to this definition"></a></dt>
<dd><p>If True, use flyback (unipolar) readout</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">blip_duration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0001</span></em><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">echo_spacing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0005</span></em><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">flat_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0003</span></em><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">flyback</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">fov</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(0.24,</span> <span class="pre">0.24)</span></em><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kspace_simulator.EPIParameters.lines_per_shot">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lines_per_shot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#kspace_simulator.EPIParameters.lines_per_shot" title="Link to this definition"></a></dt>
<dd><p>Number of phase-encode lines per shot.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">matrix_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(64,</span> <span class="pre">64)</span></em><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">n_shots</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">partial_fourier</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">ramp_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0001</span></em><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kspace_simulator.EddyCurrentModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kspace_simulator.</span></span><span class="sig-name descname"><span class="pre">EddyCurrentModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitudes:</span> <span class="pre">~typing.List[float]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_constants:</span> <span class="pre">~typing.List[float]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes:</span> <span class="pre">~typing.List[str</span> <span class="pre">|</span> <span class="pre">None]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_terms:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Tuple[float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kspace_simulator.html#EddyCurrentModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.EddyCurrentModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Model for gradient eddy currents.</p>
<dl class="simple">
<dt>Eddy currents cause the actual gradient to differ from the commanded gradient:</dt><dd><p>G_actual(t) = G_commanded(t) - ΔG(t)</p>
</dd>
</dl>
<p>Where ΔG(t) is a sum of exponential decays from previous gradient changes.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EddyCurrentModel.amplitudes">
<span class="sig-name descname"><span class="pre">amplitudes</span></span><a class="headerlink" href="#kspace_simulator.EddyCurrentModel.amplitudes" title="Link to this definition"></a></dt>
<dd><p>Relative amplitude of each eddy current component (fraction of step)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EddyCurrentModel.time_constants">
<span class="sig-name descname"><span class="pre">time_constants</span></span><a class="headerlink" href="#kspace_simulator.EddyCurrentModel.time_constants" title="Link to this definition"></a></dt>
<dd><p>Time constant (tau) for each component in seconds</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EddyCurrentModel.axes">
<span class="sig-name descname"><span class="pre">axes</span></span><a class="headerlink" href="#kspace_simulator.EddyCurrentModel.axes" title="Link to this definition"></a></dt>
<dd><p>Which axes each component affects (‘x’, ‘y’, ‘z’, or None for all)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.EddyCurrentModel.cross_terms">
<span class="sig-name descname"><span class="pre">cross_terms</span></span><a class="headerlink" href="#kspace_simulator.EddyCurrentModel.cross_terms" title="Link to this definition"></a></dt>
<dd><p>Cross-term eddy currents, e.g., {‘xy’: (amplitude, tau)} means
x-gradient causes eddy current on y-axis</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">amplitudes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.EddyCurrentModel.apply_to_gradient">
<span class="sig-name descname"><span class="pre">apply_to_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#EddyCurrentModel.apply_to_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.EddyCurrentModel.apply_to_gradient" title="Link to this definition"></a></dt>
<dd><p>Apply eddy current distortion to gradient waveform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gradient</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>ntime</em><em>, </em><em>3</em><em>)</em>) – Commanded gradient waveform [Gx, Gy, Gz] in G/cm</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Time step in seconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Actual gradient after eddy current effects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (ntime, 3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">cross_terms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">time_constants</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id26" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kspace_simulator.</span></span><span class="sig-name descname"><span class="pre">KSpaceSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42576000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Signal-based MRI simulator with k-space encoding.</p>
<p>This simulator properly models the MRI signal as the coherent sum of
all spin contributions with gradient-induced phase encoding:</p>
<blockquote>
<div><p>S(t) = ∫ M_xy(r,t) × ρ(r) × C(r) × exp(-i·2π·k(t)·r) dr</p>
</div></blockquote>
<dl class="simple">
<dt>Where:</dt><dd><ul class="simple">
<li><p>M_xy(r,t) = transverse magnetization at position r, time t</p></li>
<li><p>ρ(r) = proton density</p></li>
<li><p>C(r) = coil sensitivity</p></li>
<li><p>k(t) = ∫₀ᵗ γ·G(t’) dt’ = k-space position</p></li>
</ul>
</dd>
<dt>This enables simulation of:</dt><dd><ul class="simple">
<li><p>Spatial encoding artifacts (aliasing, ringing)</p></li>
<li><p>Eddy current effects on phase/frequency</p></li>
<li><p>EPI Nyquist ghosting</p></li>
<li><p>Chemical shift displacement</p></li>
<li><p>Off-resonance blurring</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamma</strong> (<em>float</em>) – Gyromagnetic ratio in Hz/T (default: 42.576e6 for ¹H)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print progress messages</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.generate_cartesian_trajectory">
<span class="sig-name descname"><span class="pre">generate_cartesian_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwell_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.generate_cartesian_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.generate_cartesian_trajectory" title="Link to this definition"></a></dt>
<dd><p>Generate Cartesian k-space trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix_size</strong> (<em>tuple</em>) – (nx,), (nx, ny), or (nx, ny, nz)</p></li>
<li><p><strong>fov</strong> (<em>tuple</em>) – Field of view in meters, matching matrix_size dimensions</p></li>
<li><p><strong>dwell_time</strong> (<em>float</em>) – ADC dwell time in seconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>‘kx’, ‘ky’, ‘kz’: k-space coordinates in cycles/m
‘time’: time points in seconds
‘sample_indices’: indices into full k-space grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict with</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.generate_csi_trajectory">
<span class="sig-name descname"><span class="pre">generate_csi_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#kspace_simulator.CSIParameters" title="kspace_simulator.CSIParameters"><span class="pre">CSIParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.generate_csi_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.generate_csi_trajectory" title="Link to this definition"></a></dt>
<dd><p>Generate CSI (Chemical Shift Imaging) trajectory.</p>
<p>CSI uses phase encoding for spatial dimensions and free precession
for the spectral dimension. Each k-space point requires a separate
excitation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#kspace_simulator.CSIParameters" title="kspace_simulator.CSIParameters"><em>CSIParameters</em></a>) – CSI sequence parameters</p></li>
<li><p><strong>dt</strong> (<em>float</em><em>, </em><em>optional</em>) – Time step (defaults to dwell_time)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict with trajectory information</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.generate_epi_trajectory">
<span class="sig-name descname"><span class="pre">generate_epi_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#kspace_simulator.EPIParameters" title="kspace_simulator.EPIParameters"><span class="pre">EPIParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.generate_epi_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.generate_epi_trajectory" title="Link to this definition"></a></dt>
<dd><p>Generate EPI k-space trajectory with realistic timing.</p>
<p>This generates the actual gradient waveforms and k-space trajectory
for echo-planar imaging, including:
- Trapezoidal readout gradients
- Phase-encode blips
- Alternating readout direction (or flyback)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference internal" href="#kspace_simulator.EPIParameters" title="kspace_simulator.EPIParameters"><em>EPIParameters</em></a>) – EPI sequence parameters</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Simulation time step in seconds</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict with trajectory and gradient information</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.log" title="Link to this definition"></a></dt>
<dd><p>Log a message.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.reconstruct_cartesian">
<span class="sig-name descname"><span class="pre">reconstruct_cartesian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.reconstruct_cartesian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.reconstruct_cartesian" title="Link to this definition"></a></dt>
<dd><p>Reconstruct image from Cartesian k-space data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>signal_data</strong> (<em>dict</em>) – Output from simulate_signal() with Cartesian trajectory</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reconstructed image (complex)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.reconstruct_csi">
<span class="sig-name descname"><span class="pre">reconstruct_csi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.reconstruct_csi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.reconstruct_csi" title="Link to this definition"></a></dt>
<dd><p>Reconstruct CSI data to spatial-spectral cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>signal_data</strong> (<em>dict</em>) – Output from simulate_signal() with CSI trajectory</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Spatial-spectral data, shape (<a href="#id27"><span class="problematic" id="id28">*</span></a>spatial_shape, n_spectral)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.reconstruct_epi">
<span class="sig-name descname"><span class="pre">reconstruct_epi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_correction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.reconstruct_epi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.reconstruct_epi" title="Link to this definition"></a></dt>
<dd><p>Reconstruct EPI with optional phase correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal_data</strong> (<em>dict</em>) – Output from simulate_signal() with EPI trajectory</p></li>
<li><p><strong>phase_correction</strong> (<em>str</em>) – ‘none’: No correction
‘linear’: Linear phase correction per line
‘navigator’: Navigator-based correction (requires navigator echoes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reconstructed image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.set_log_callback">
<span class="sig-name descname"><span class="pre">set_log_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.set_log_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.set_log_callback" title="Link to this definition"></a></dt>
<dd><p>Set callback for log messages.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kspace_simulator.KSpaceSimulator.simulate_signal">
<span class="sig-name descname"><span class="pre">simulate_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phantom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnetization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eddy_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#kspace_simulator.EddyCurrentModel" title="kspace_simulator.EddyCurrentModel"><span class="pre">EddyCurrentModel</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coil_sensitivity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#KSpaceSimulator.simulate_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.KSpaceSimulator.simulate_signal" title="Link to this definition"></a></dt>
<dd><p>Simulate MRI signal from phantom with k-space encoding.</p>
<dl class="simple">
<dt>This is the core function that computes:</dt><dd><p>S(t) = Σᵣ M_xy(r,t) × ρ(r) × C(r) × exp(-i·2π·k(t)·r + φ_B0(r,t))</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phantom</strong> (<a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><em>Phantom</em></a>) – Phantom object with tissue properties</p></li>
<li><p><strong>trajectory</strong> (<em>dict</em>) – K-space trajectory from generate_*_trajectory()</p></li>
<li><p><strong>magnetization</strong> (<em>dict</em><em>, </em><em>optional</em>) – Pre-computed magnetization from Bloch simulation.
If None, uses equilibrium M_xy = 1.</p></li>
<li><p><strong>eddy_model</strong> (<a class="reference internal" href="#kspace_simulator.EddyCurrentModel" title="kspace_simulator.EddyCurrentModel"><em>EddyCurrentModel</em></a><em>, </em><em>optional</em>) – Eddy current model to apply to gradients</p></li>
<li><p><strong>b0_map</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – B0 inhomogeneity map in Hz, shape matching phantom.shape</p></li>
<li><p><strong>coil_sensitivity</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Complex coil sensitivity map, shape matching phantom.shape</p></li>
<li><p><strong>noise_std</strong> (<em>float</em>) – Standard deviation of complex Gaussian noise to add</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>‘signal’: Complex signal at each k-space point
‘kx’, ‘ky’, ‘kz’: Actual k-space coordinates (may differ from</p>
<blockquote>
<div><p>trajectory if eddy currents applied)</p>
</div></blockquote>
<p>’time’: Time points</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict with</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kspace_simulator.TrajectoryType">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kspace_simulator.</span></span><span class="sig-name descname"><span class="pre">TrajectoryType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kspace_simulator.html#TrajectoryType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.TrajectoryType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>K-space trajectory types.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.TrajectoryType.CARTESIAN">
<span class="sig-name descname"><span class="pre">CARTESIAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'cartesian'</span></em><a class="headerlink" href="#kspace_simulator.TrajectoryType.CARTESIAN" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.TrajectoryType.CSI">
<span class="sig-name descname"><span class="pre">CSI</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'csi'</span></em><a class="headerlink" href="#kspace_simulator.TrajectoryType.CSI" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.TrajectoryType.CUSTOM">
<span class="sig-name descname"><span class="pre">CUSTOM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'custom'</span></em><a class="headerlink" href="#kspace_simulator.TrajectoryType.CUSTOM" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.TrajectoryType.EPI">
<span class="sig-name descname"><span class="pre">EPI</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'epi'</span></em><a class="headerlink" href="#kspace_simulator.TrajectoryType.EPI" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.TrajectoryType.RADIAL">
<span class="sig-name descname"><span class="pre">RADIAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'radial'</span></em><a class="headerlink" href="#kspace_simulator.TrajectoryType.RADIAL" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="kspace_simulator.TrajectoryType.SPIRAL">
<span class="sig-name descname"><span class="pre">SPIRAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'spiral'</span></em><a class="headerlink" href="#kspace_simulator.TrajectoryType.SPIRAL" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kspace_simulator.simulate_csi_spectrum">
<span class="sig-prename descclassname"><span class="pre">kspace_simulator.</span></span><span class="sig-name descname"><span class="pre">simulate_csi_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phantom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csi_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#kspace_simulator.CSIParameters" title="kspace_simulator.CSIParameters"><span class="pre">CSIParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">excitation_flip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#simulate_csi_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.simulate_csi_spectrum" title="Link to this definition"></a></dt>
<dd><p>Convenience function to simulate CSI experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phantom</strong> (<a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><em>Phantom</em></a><em> or </em><em>SpectralPhantom</em>) – Phantom with chemical shift information in df_map</p></li>
<li><p><strong>csi_params</strong> (<a class="reference internal" href="#kspace_simulator.CSIParameters" title="kspace_simulator.CSIParameters"><em>CSIParameters</em></a>) – CSI sequence parameters</p></li>
<li><p><strong>excitation_flip</strong> (<em>float</em>) – Excitation flip angle in degrees</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print progress</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict with spectra and images</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kspace_simulator.simulate_epi_with_artifacts">
<span class="sig-prename descclassname"><span class="pre">kspace_simulator.</span></span><span class="sig-name descname"><span class="pre">simulate_epi_with_artifacts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phantom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epi_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#kspace_simulator.EPIParameters" title="kspace_simulator.EPIParameters"><span class="pre">EPIParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eddy_amplitudes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eddy_taus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0_inhomogeneity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/kspace_simulator.html#simulate_epi_with_artifacts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kspace_simulator.simulate_epi_with_artifacts" title="Link to this definition"></a></dt>
<dd><p>Convenience function to simulate EPI with common artifacts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phantom</strong> (<a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><em>Phantom</em></a>) – Phantom object</p></li>
<li><p><strong>epi_params</strong> (<a class="reference internal" href="#kspace_simulator.EPIParameters" title="kspace_simulator.EPIParameters"><em>EPIParameters</em></a>) – EPI sequence parameters</p></li>
<li><p><strong>eddy_amplitudes</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Eddy current amplitudes (relative to gradient step)</p></li>
<li><p><strong>eddy_taus</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Eddy current time constants in seconds</p></li>
<li><p><strong>b0_inhomogeneity</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – B0 map in Hz</p></li>
<li><p><strong>noise_level</strong> (<em>float</em>) – Noise standard deviation</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print progress</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict with images and intermediate data</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-phantom">
<span id="phantoms"></span><h2>Phantoms<a class="headerlink" href="#module-phantom" title="Link to this heading"></a></h2>
<p>phantom.py - MRI Phantom classes for heterogeneous tissue simulation</p>
<p>This module provides data structures for representing 2D/3D imaging phantoms
with spatially-varying tissue properties (T1, T2, proton density, frequency offset).</p>
<p>Author: Luca Nagel
Date: 2024/2025</p>
<dl class="py class">
<dt class="sig sig-object py" id="phantom.Phantom">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phantom.</span></span><span class="sig-name descname"><span class="pre">Phantom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">shape:</span> <span class="pre">~typing.Tuple[int,</span> <span class="pre">...],</span> <span class="pre">fov:</span> <span class="pre">~typing.Tuple[float,</span> <span class="pre">...],</span> <span class="pre">t1_map:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">t2_map:</span> <span class="pre">~numpy.ndarray,</span> <span class="pre">pd_map:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">df_map:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">m0_map:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">mask:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'Phantom',</span> <span class="pre">metadata:</span> <span class="pre">~typing.Dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/phantom.html#Phantom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.Phantom" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MRI phantom with spatially-varying tissue properties.</p>
<p>A Phantom represents a 1D, 2D, or 3D imaging object where each voxel
can have different T1, T2, proton density, and frequency offset values.
This enables realistic simulation of heterogeneous tissue.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#phantom.Phantom.shape" title="Link to this definition"></a></dt>
<dd><p>Spatial dimensions: (nx,) for 1D, (nx, ny) for 2D, or (nx, ny, nz) for 3D</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.fov">
<span class="sig-name descname"><span class="pre">fov</span></span><a class="headerlink" href="#phantom.Phantom.fov" title="Link to this definition"></a></dt>
<dd><p>Field of view in meters for each dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.t1_map">
<span class="sig-name descname"><span class="pre">t1_map</span></span><a class="headerlink" href="#phantom.Phantom.t1_map" title="Link to this definition"></a></dt>
<dd><p>T1 relaxation times in seconds, shape matches <cite>shape</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.t2_map">
<span class="sig-name descname"><span class="pre">t2_map</span></span><a class="headerlink" href="#phantom.Phantom.t2_map" title="Link to this definition"></a></dt>
<dd><p>T2 relaxation times in seconds, shape matches <cite>shape</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.pd_map">
<span class="sig-name descname"><span class="pre">pd_map</span></span><a class="headerlink" href="#phantom.Phantom.pd_map" title="Link to this definition"></a></dt>
<dd><p>Proton density (relative), range [0, 1]. Default: all ones</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.df_map">
<span class="sig-name descname"><span class="pre">df_map</span></span><a class="headerlink" href="#phantom.Phantom.df_map" title="Link to this definition"></a></dt>
<dd><p>Off-resonance frequency in Hz (for B0 inhomogeneity). Default: all zeros</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.m0_map">
<span class="sig-name descname"><span class="pre">m0_map</span></span><a class="headerlink" href="#phantom.Phantom.m0_map" title="Link to this definition"></a></dt>
<dd><p>Initial magnetization, shape (<a href="#id29"><span class="problematic" id="id30">*</span></a>shape, 3) for [Mx, My, Mz]. Default: [0, 0, 1]</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.mask">
<span class="sig-name descname"><span class="pre">mask</span></span><a class="headerlink" href="#phantom.Phantom.mask" title="Link to this definition"></a></dt>
<dd><p>Boolean mask indicating tissue vs. background. Default: all True</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#phantom.Phantom.name" title="Link to this definition"></a></dt>
<dd><p>Descriptive name for the phantom</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#phantom.Phantom.metadata" title="Link to this definition"></a></dt>
<dd><p>Additional metadata (field strength, creation info, etc.)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict, optional</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a simple 2D phantom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.0</span>  <span class="c1"># 1 second T1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># 100 ms T2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phantom</span> <span class="o">=</span> <span class="n">Phantom</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">fov</span><span class="o">=</span><span class="p">(</span><span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">),</span>  <span class="c1"># 24 cm FOV</span>
<span class="gp">... </span>    <span class="n">t1_map</span><span class="o">=</span><span class="n">t1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">t2_map</span><span class="o">=</span><span class="n">t2</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Phantom has </span><span class="si">{</span><span class="n">phantom</span><span class="o">.</span><span class="n">nvoxels</span><span class="si">}</span><span class="s2"> voxels&quot;</span><span class="p">)</span>
<span class="go">Phantom has 4096 voxels</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="phantom.Phantom.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#Phantom.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.Phantom.copy" title="Link to this definition"></a></dt>
<dd><p>Create a deep copy of the phantom.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id31">
<span class="sig-name descname"><span class="pre">df_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id31" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id32">
<span class="sig-name descname"><span class="pre">fov</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id32" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.Phantom.get_active_properties">
<span class="sig-name descname"><span class="pre">get_active_properties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/phantom.html#Phantom.get_active_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.Phantom.get_active_properties" title="Link to this definition"></a></dt>
<dd><p>Return flattened arrays for active (non-masked) voxels only.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Same structure as get_flat_properties(), but only including
voxels where mask is True.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.Phantom.get_flat_properties">
<span class="sig-name descname"><span class="pre">get_flat_properties</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/phantom.html#Phantom.get_flat_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.Phantom.get_flat_properties" title="Link to this definition"></a></dt>
<dd><p>Return flattened arrays for simulation.</p>
<p>All property maps are flattened to 1D arrays suitable for
passing to the simulation core.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary with keys:
- ‘positions’: (nvoxels, 3) array of [x, y, z] coordinates in meters
- ‘t1’: (nvoxels,) array of T1 values in seconds
- ‘t2’: (nvoxels,) array of T2 values in seconds
- ‘pd’: (nvoxels,) array of proton density values
- ‘df’: (nvoxels,) array of frequency offsets in Hz
- ‘m0’: (nvoxels, 3) array of initial magnetization [Mx, My, Mz]
- ‘mask’: (nvoxels,) boolean array</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.Phantom.load">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#Phantom.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.Phantom.load" title="Link to this definition"></a></dt>
<dd><p>Load phantom from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em><em> or </em><em>Path</em>) – Input filename (.npz or .h5/.hdf5)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded phantom object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom">Phantom</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id33">
<span class="sig-name descname"><span class="pre">m0_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id33" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id34">
<span class="sig-name descname"><span class="pre">mask</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id34" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id35">
<span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#id35" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="phantom.Phantom.n_active">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_active</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#phantom.Phantom.n_active" title="Link to this definition"></a></dt>
<dd><p>Number of active (non-masked) voxels.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id36">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Phantom'</span></em><a class="headerlink" href="#id36" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="phantom.Phantom.ndim">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#phantom.Phantom.ndim" title="Link to this definition"></a></dt>
<dd><p>Number of spatial dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="phantom.Phantom.nvoxels">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvoxels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#phantom.Phantom.nvoxels" title="Link to this definition"></a></dt>
<dd><p>Total number of voxels.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id37">
<span class="sig-name descname"><span class="pre">pd_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id37" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.positions">
<span class="sig-name descname"><span class="pre">positions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#phantom.Phantom.positions" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.Phantom.reconstruct_from_active">
<span class="sig-name descname"><span class="pre">reconstruct_from_active</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">active_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/phantom.html#Phantom.reconstruct_from_active"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.Phantom.reconstruct_from_active" title="Link to this definition"></a></dt>
<dd><p>Reconstruct full phantom-shaped array from active-only simulation result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>active_array</strong> (<em>ndarray</em>) – Result for active voxels only.
Shape: (ntime, n_active) if has_time=True, else (n_active,)</p></li>
<li><p><strong>indices</strong> (<em>ndarray</em>) – Original indices of active voxels (from get_active_properties)</p></li>
<li><p><strong>has_time</strong> (<em>bool</em>) – Whether the first dimension is time</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) – Value to use for masked voxels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full array with shape (ntime, <a href="#id38"><span class="problematic" id="id39">*</span></a>self.shape) or (<a href="#id40"><span class="problematic" id="id41">*</span></a>self.shape,)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.Phantom.reshape_result">
<span class="sig-name descname"><span class="pre">reshape_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flat_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/phantom.html#Phantom.reshape_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.Phantom.reshape_result" title="Link to this definition"></a></dt>
<dd><p>Reshape flat simulation result back to phantom shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flat_array</strong> (<em>ndarray</em>) – Flattened result from simulation.
Shape: (ntime, nvoxels) if has_time=True, else (nvoxels,)</p></li>
<li><p><strong>has_time</strong> (<em>bool</em>) – Whether the first dimension is time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reshaped array with shape (<a href="#id42"><span class="problematic" id="id43">*</span></a>self.shape,) or (ntime, <a href="#id44"><span class="problematic" id="id45">*</span></a>self.shape)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="phantom.Phantom.resolution">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">resolution</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#phantom.Phantom.resolution" title="Link to this definition"></a></dt>
<dd><p>Voxel size in meters for each dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.Phantom.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/phantom.html#Phantom.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.Phantom.save" title="Link to this definition"></a></dt>
<dd><p>Save phantom to file.</p>
<p>Supports .npz (NumPy) and .h5 (HDF5) formats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em><em> or </em><em>Path</em>) – Output filename. Extension determines format.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id46">
<span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id46" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id47">
<span class="sig-name descname"><span class="pre">t1_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#id47" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id48">
<span class="sig-name descname"><span class="pre">t2_map</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#id48" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.x">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#phantom.Phantom.x" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.y">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#phantom.Phantom.y" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.Phantom.z">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#phantom.Phantom.z" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="phantom.PhantomFactory">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">phantom.</span></span><span class="sig-name descname"><span class="pre">PhantomFactory</span></span><a class="reference internal" href="_modules/phantom.html#PhantomFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Factory methods for creating common phantom types.</p>
<p>This class provides static methods to create standard phantoms
like Shepp-Logan, spherical phantoms, and phantoms from segmentations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="phantom.PhantomFactory.TISSUE_PARAMS">
<span class="sig-name descname"><span class="pre">TISSUE_PARAMS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'blood':</span> <span class="pre">{1.5:</span> <span class="pre">(1.44,</span> <span class="pre">0.29,</span> <span class="pre">1.0),</span> <span class="pre">3.0:</span> <span class="pre">(1.93,</span> <span class="pre">0.275,</span> <span class="pre">1.0),</span> <span class="pre">7.0:</span> <span class="pre">(2.59,</span> <span class="pre">0.11,</span> <span class="pre">1.0)},</span> <span class="pre">'csf':</span> <span class="pre">{1.5:</span> <span class="pre">(2.5,</span> <span class="pre">2.0,</span> <span class="pre">1.0),</span> <span class="pre">3.0:</span> <span class="pre">(3.8,</span> <span class="pre">2.0,</span> <span class="pre">1.0),</span> <span class="pre">7.0:</span> <span class="pre">(4.4,</span> <span class="pre">1.5,</span> <span class="pre">1.0)},</span> <span class="pre">'fat':</span> <span class="pre">{1.5:</span> <span class="pre">(0.27,</span> <span class="pre">0.085,</span> <span class="pre">1.0),</span> <span class="pre">3.0:</span> <span class="pre">(0.37,</span> <span class="pre">0.133,</span> <span class="pre">1.0),</span> <span class="pre">7.0:</span> <span class="pre">(0.52,</span> <span class="pre">0.046,</span> <span class="pre">1.0)},</span> <span class="pre">'gray_matter':</span> <span class="pre">{1.5:</span> <span class="pre">(0.95,</span> <span class="pre">0.1,</span> <span class="pre">0.95),</span> <span class="pre">3.0:</span> <span class="pre">(1.33,</span> <span class="pre">0.083,</span> <span class="pre">0.95),</span> <span class="pre">7.0:</span> <span class="pre">(1.92,</span> <span class="pre">0.047,</span> <span class="pre">0.95)},</span> <span class="pre">'muscle':</span> <span class="pre">{1.5:</span> <span class="pre">(0.87,</span> <span class="pre">0.047,</span> <span class="pre">1.0),</span> <span class="pre">3.0:</span> <span class="pre">(1.42,</span> <span class="pre">0.032,</span> <span class="pre">1.0),</span> <span class="pre">7.0:</span> <span class="pre">(1.9,</span> <span class="pre">0.022,</span> <span class="pre">1.0)},</span> <span class="pre">'white_matter':</span> <span class="pre">{1.5:</span> <span class="pre">(0.65,</span> <span class="pre">0.07,</span> <span class="pre">0.77),</span> <span class="pre">3.0:</span> <span class="pre">(0.83,</span> <span class="pre">0.07,</span> <span class="pre">0.77),</span> <span class="pre">7.0:</span> <span class="pre">(1.22,</span> <span class="pre">0.046,</span> <span class="pre">0.77)}}</span></em><a class="headerlink" href="#phantom.PhantomFactory.TISSUE_PARAMS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.PhantomFactory.chemical_shift_phantom">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chemical_shift_phantom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#PhantomFactory.chemical_shift_phantom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory.chemical_shift_phantom" title="Link to this definition"></a></dt>
<dd><p>Create phantom with water and fat regions for chemical shift imaging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Matrix size</p></li>
<li><p><strong>fov</strong> (<em>float</em>) – Field of view in meters</p></li>
<li><p><strong>field_strength</strong> (<em>float</em>) – B0 field strength in Tesla (affects chemical shift in Hz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Phantom with separate water and fat regions, including
frequency offset for fat chemical shift</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom">Phantom</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.PhantomFactory.cylindrical_2d">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cylindrical_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gray_matter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#PhantomFactory.cylindrical_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory.cylindrical_2d" title="Link to this definition"></a></dt>
<dd><p>Create 2D circular (cylindrical cross-section) phantom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Matrix size (n x n)</p></li>
<li><p><strong>fov</strong> (<em>float</em>) – Field of view in meters</p></li>
<li><p><strong>tissue</strong> (<em>str</em>) – Tissue type name</p></li>
<li><p><strong>field_strength</strong> (<em>float</em>) – B0 field strength in Tesla</p></li>
<li><p><strong>radius_fraction</strong> (<em>float</em>) – Circle radius as fraction of FOV</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom">Phantom</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.PhantomFactory.from_segmentation">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_segmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_to_tissue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Segmented'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#PhantomFactory.from_segmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory.from_segmentation" title="Link to this definition"></a></dt>
<dd><p>Create phantom from segmentation labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_labels</strong> (<em>ndarray</em>) – Integer array with tissue labels (0 = background)</p></li>
<li><p><strong>label_to_tissue</strong> (<em>dict</em>) – Mapping from label to tissue name
e.g., {1: ‘gray_matter’, 2: ‘white_matter’, 3: ‘csf’}</p></li>
<li><p><strong>fov</strong> (<em>tuple</em>) – Field of view in meters for each dimension</p></li>
<li><p><strong>field_strength</strong> (<em>float</em>) – B0 field strength in Tesla</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Phantom name</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom">Phantom</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.PhantomFactory.get_tissue_params">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_tissue_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tissue_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/phantom.html#PhantomFactory.get_tissue_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory.get_tissue_params" title="Link to this definition"></a></dt>
<dd><p>Get T1, T2, PD for a tissue type at a given field strength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tissue_name</strong> (<em>str</em>) – Tissue name (e.g., ‘gray_matter’, ‘white_matter’)</p></li>
<li><p><strong>field_strength</strong> (<em>float</em>) – B0 field strength in Tesla</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(T1, T2, PD) - T1 and T2 in seconds, PD relative (0-1)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.PhantomFactory.multi_tissue_2d">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">multi_tissue_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#PhantomFactory.multi_tissue_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory.multi_tissue_2d" title="Link to this definition"></a></dt>
<dd><p>Create 2D phantom with multiple tissue types arranged in quadrants.</p>
<p>Useful for testing tissue contrast.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Phantom with gray matter, white matter, CSF, and fat in quadrants</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom">Phantom</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.PhantomFactory.shepp_logan_2d">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shepp_logan_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#PhantomFactory.shepp_logan_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory.shepp_logan_2d" title="Link to this definition"></a></dt>
<dd><p>Create 2D Shepp-Logan phantom with realistic T1/T2 values.</p>
<p>The Shepp-Logan phantom is a standard test phantom used in
medical imaging. This version assigns realistic brain tissue
properties based on the phantom regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Matrix size (n x n)</p></li>
<li><p><strong>fov</strong> (<em>float</em>) – Field of view in meters</p></li>
<li><p><strong>field_strength</strong> (<em>float</em>) – B0 field strength in Tesla (affects T1/T2 values)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Shepp-Logan phantom with tissue-specific T1/T2</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom">Phantom</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.PhantomFactory.spherical_3d">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spherical_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tissue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gray_matter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#PhantomFactory.spherical_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory.spherical_3d" title="Link to this definition"></a></dt>
<dd><p>Create 3D spherical phantom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Matrix size (n x n x n)</p></li>
<li><p><strong>fov</strong> (<em>float</em>) – Field of view in meters</p></li>
<li><p><strong>tissue</strong> (<em>str</em>) – Tissue type name</p></li>
<li><p><strong>field_strength</strong> (<em>float</em>) – B0 field strength in Tesla</p></li>
<li><p><strong>radius_fraction</strong> (<em>float</em>) – Sphere radius as fraction of FOV (0-0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom">Phantom</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="phantom.PhantomFactory.uniform">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fov</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Uniform'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></span><a class="reference internal" href="_modules/phantom.html#PhantomFactory.uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.PhantomFactory.uniform" title="Link to this definition"></a></dt>
<dd><p>Create a uniform phantom with constant tissue properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – Spatial dimensions</p></li>
<li><p><strong>fov</strong> (<em>tuple</em>) – Field of view in meters</p></li>
<li><p><strong>t1</strong> (<em>float</em>) – T1 relaxation time in seconds</p></li>
<li><p><strong>t2</strong> (<em>float</em>) – T2 relaxation time in seconds</p></li>
<li><p><strong>pd</strong> (<em>float</em>) – Proton density (0-1)</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Phantom name</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom">Phantom</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="phantom.display_phantom">
<span class="sig-prename descclassname"><span class="pre">phantom.</span></span><span class="sig-name descname"><span class="pre">display_phantom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phantom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><span class="pre">Phantom</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_all_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/phantom.html#display_phantom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#phantom.display_phantom" title="Link to this definition"></a></dt>
<dd><p>Display phantom maps using matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phantom</strong> (<a class="reference internal" href="#phantom.Phantom" title="phantom.Phantom"><em>Phantom</em></a>) – Phantom to display</p></li>
<li><p><strong>slice_idx</strong> (<em>int</em><em>, </em><em>optional</em>) – For 3D phantoms, which slice to show. Default: middle slice</p></li>
<li><p><strong>show_all_maps</strong> (<em>bool</em>) – If True, show T1, T2, PD, and mask. If False, only T1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pulse_loader">
<span id="pulse-loader"></span><h2>Pulse Loader<a class="headerlink" href="#module-pulse_loader" title="Link to this heading"></a></h2>
<p>pulse_loader.py - RF Pulse loading and processing pipeline</p>
<p>This module provides utilities to load and process RF pulses from various formats,
including Bruker JCAMP-DX format (.exc files).</p>
<p>Author: Your Name
Date: 2024</p>
<dl class="py class">
<dt class="sig sig-object py" id="pulse_loader.JCAMPPulseLoader">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pulse_loader.</span></span><span class="sig-name descname"><span class="pre">JCAMPPulseLoader</span></span><a class="reference internal" href="_modules/pulse_loader.html#JCAMPPulseLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.JCAMPPulseLoader" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Load RF pulses from Bruker JCAMP-DX format (.exc files).</p>
<dl class="py method">
<dt class="sig sig-object py" id="pulse_loader.JCAMPPulseLoader.load">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pulse_loader.PulseMetadata" title="pulse_loader.PulseMetadata"><span class="pre">PulseMetadata</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pulse_loader.html#JCAMPPulseLoader.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.JCAMPPulseLoader.load" title="Link to this definition"></a></dt>
<dd><p>Load an RF pulse from a JCAMP-DX file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>str</em><em> or </em><em>Path</em>) – Path to the .exc file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>b1</strong> (<em>ndarray</em>) – Complex B1 field (Gauss)</p></li>
<li><p><strong>time</strong> (<em>ndarray</em>) – Time array (seconds)</p></li>
<li><p><strong>metadata</strong> (<em>PulseMetadata</em>) – Metadata extracted from the file</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pulse_loader.PulseLibrary">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pulse_loader.</span></span><span class="sig-name descname"><span class="pre">PulseLibrary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pulse_loader.html#PulseLibrary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.PulseLibrary" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Manage a library of RF pulses.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pulse_loader.PulseLibrary.list_pulses">
<span class="sig-name descname"><span class="pre">list_pulses</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/pulse_loader.html#PulseLibrary.list_pulses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.PulseLibrary.list_pulses" title="Link to this definition"></a></dt>
<dd><p>List all available pulses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulse_loader.PulseLibrary.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pulse_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pulse_loader.PulseMetadata" title="pulse_loader.PulseMetadata"><span class="pre">PulseMetadata</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pulse_loader.html#PulseLibrary.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.PulseLibrary.load" title="Link to this definition"></a></dt>
<dd><p>Load a pulse by name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pulse_name</strong> (<em>str</em>) – Name of the pulse (without .exc extension)
Can use ‘/’ as path separator, e.g., ‘bruker/13C_Ultimate_SPSP_Pulse_QuEMRT’</p></li>
<li><p><strong>use_cache</strong> (<em>bool</em>) – Whether to cache loaded pulses</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>b1</strong> (<em>ndarray</em>) – Complex B1 field (Gauss)</p></li>
<li><p><strong>time</strong> (<em>ndarray</em>) – Time array (seconds)</p></li>
<li><p><strong>metadata</strong> (<em>PulseMetadata</em>) – Metadata from the pulse file</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulse_loader.PulseLibrary.load_from_file">
<span class="sig-name descname"><span class="pre">load_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pulse_loader.PulseMetadata" title="pulse_loader.PulseMetadata"><span class="pre">PulseMetadata</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pulse_loader.html#PulseLibrary.load_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.PulseLibrary.load_from_file" title="Link to this definition"></a></dt>
<dd><p>Load a pulse directly from a file path.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pulse_loader.</span></span><span class="sig-name descname"><span class="pre">PulseMetadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nucleus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Proton'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_strength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_b1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'conventional'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Excitation'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_slew</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integfac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rephfac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwfac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miny</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">360.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pulse_loader.html#PulseMetadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.PulseMetadata" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for RF pulse metadata.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.bwfac">
<span class="sig-name descname"><span class="pre">bwfac</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.bwfac" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.duration">
<span class="sig-name descname"><span class="pre">duration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.duration" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.field_strength">
<span class="sig-name descname"><span class="pre">field_strength</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.field_strength" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.flip_angle">
<span class="sig-name descname"><span class="pre">flip_angle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">90.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.flip_angle" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.integfac">
<span class="sig-name descname"><span class="pre">integfac</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.integfac" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.max_b1">
<span class="sig-name descname"><span class="pre">max_b1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.max_b1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.max_grad">
<span class="sig-name descname"><span class="pre">max_grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.max_grad" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.max_slew">
<span class="sig-name descname"><span class="pre">max_slew</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.max_slew" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.maxx">
<span class="sig-name descname"><span class="pre">maxx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.maxx" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.maxy">
<span class="sig-name descname"><span class="pre">maxy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">360.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.maxy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.minx">
<span class="sig-name descname"><span class="pre">minx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.minx" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.miny">
<span class="sig-name descname"><span class="pre">miny</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.miny" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.npoints">
<span class="sig-name descname"><span class="pre">npoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.npoints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.nucleus">
<span class="sig-name descname"><span class="pre">nucleus</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Proton'</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.nucleus" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.origin">
<span class="sig-name descname"><span class="pre">origin</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.origin" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.rephfac">
<span class="sig-name descname"><span class="pre">rephfac</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.rephfac" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.shape_mode">
<span class="sig-name descname"><span class="pre">shape_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Excitation'</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.shape_mode" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.shape_type">
<span class="sig-name descname"><span class="pre">shape_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'conventional'</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.shape_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.slice_offset">
<span class="sig-name descname"><span class="pre">slice_offset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.slice_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.slice_width">
<span class="sig-name descname"><span class="pre">slice_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.slice_width" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.title">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#pulse_loader.PulseMetadata.title" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulse_loader.PulseMetadata.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/pulse_loader.html#PulseMetadata.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.PulseMetadata.to_dict" title="Link to this definition"></a></dt>
<dd><p>Convert metadata to dictionary.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulse_loader.get_pulse_library">
<span class="sig-prename descclassname"><span class="pre">pulse_loader.</span></span><span class="sig-name descname"><span class="pre">get_pulse_library</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pulse_loader.PulseLibrary" title="pulse_loader.PulseLibrary"><span class="pre">PulseLibrary</span></a></span></span><a class="reference internal" href="_modules/pulse_loader.html#get_pulse_library"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.get_pulse_library" title="Link to this definition"></a></dt>
<dd><p>Get or create the global pulse library.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulse_loader.load_amp_phase_dat">
<span class="sig-prename descclassname"><span class="pre">pulse_loader.</span></span><span class="sig-name descname"><span class="pre">load_amp_phase_dat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_b1_gauss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'relative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'deg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'columns'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pulse_loader.PulseMetadata" title="pulse_loader.PulseMetadata"><span class="pre">PulseMetadata</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pulse_loader.html#load_amp_phase_dat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.load_amp_phase_dat" title="Link to this definition"></a></dt>
<dd><p>Load a simple two-column .dat pulse where column 0 is relative amplitude (1.0 = 100%)
and column 1 is phase in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em><em> or </em><em>Path</em>) – Path to the .dat file.</p></li>
<li><p><strong>duration_s</strong> (<em>float</em><em>, </em><em>optional</em>) – Total pulse duration in seconds. If not provided, try to parse <cite>&lt;number&gt;ms</cite>
from the filename (e.g., <cite>AHP_5ms_Hsn.dat</cite>). Fallback is index-based timing.</p></li>
<li><p><strong>max_b1_gauss</strong> (<em>float</em><em>, </em><em>optional</em>) – Peak B1 amplitude in Gauss corresponding to amplitude=1.0. Defaults to 1.0 G.</p></li>
<li><p><strong>amplitude_unit</strong> (<em>str</em><em>, </em><em>optional</em>) – One of {“relative”, “percent”, “fraction”, “gauss”, “mt”, “ut”}.
- “relative”/”fraction”: column values are 0..1 scaling of max_b1_gauss
- “percent”: column values are 0..100 percent of max_b1_gauss
- “gauss”/”mt”/”ut”: column values are absolute amplitudes in those units</p></li>
<li><p><strong>phase_unit</strong> (<em>str</em><em>, </em><em>optional</em>) – “deg” or “rad”.</p></li>
<li><p><strong>layout</strong> (<em>str</em><em>, </em><em>optional</em>) – “columns” for amp|phase per row,
“amp_phase_interleaved” for amp, phase, amp, phase…,
“phase_amp_interleaved” for phase, amp, phase, amp…</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>b1</strong> (<em>ndarray (complex128)</em>) – Complex B1 envelope in Gauss.</p></li>
<li><p><strong>time</strong> (<em>ndarray (float64)</em>) – Time array in seconds (uniformly spaced).</p></li>
<li><p><strong>metadata</strong> (<em>PulseMetadata</em>) – Basic metadata (duration/npoints/name/max_b1).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulse_loader.load_pulse">
<span class="sig-prename descclassname"><span class="pre">pulse_loader.</span></span><span class="sig-name descname"><span class="pre">load_pulse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pulse_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pulse_loader.PulseMetadata" title="pulse_loader.PulseMetadata"><span class="pre">PulseMetadata</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pulse_loader.html#load_pulse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.load_pulse" title="Link to this definition"></a></dt>
<dd><p>Load a pulse from the global library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pulse_name</strong> (<em>str</em>) – Name of the pulse, e.g., ‘bruker/13C_Ultimate_SPSP_Pulse_QuEMRT’</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>b1</strong> (<em>ndarray</em>) – Complex B1 field (Gauss)</p></li>
<li><p><strong>time</strong> (<em>ndarray</em>) – Time array (seconds)</p></li>
<li><p><strong>metadata</strong> (<em>PulseMetadata</em>) – Metadata from the pulse file</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulse_loader.load_pulse_from_file">
<span class="sig-prename descclassname"><span class="pre">pulse_loader.</span></span><span class="sig-name descname"><span class="pre">load_pulse_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pulse_loader.PulseMetadata" title="pulse_loader.PulseMetadata"><span class="pre">PulseMetadata</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pulse_loader.html#load_pulse_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pulse_loader.load_pulse_from_file" title="Link to this definition"></a></dt>
<dd><p>Load a pulse directly from a file path.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Bloch Simulator Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Luca Nagel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
